<% @taxons = @taxon && @taxon.parent ? @taxon.parent.children : Spree::Taxon.roots %>
<% @taxonomies = @taxononomies.present? ? @taxononomies : Spree::Taxonomy.all %>

<%= form_tag spree.products_path,
             method: :get,
             class: 'navbar-form' do %>

  <div class="form-group">
    <% cache(cache_key_for_taxons) do %>
      <%= select_tag :taxononmy,
                      options_for_select(
                        [
                          [Spree.t(:all_departments), '']
                        ] + @taxonomies.map {|t| [t.name, t.id]},
                        @taxonomy ? @taxonomy.id : params[:taxon]
                      ),
                      'aria-label' => 'Taxon',
                      class: 'form-control'
      %>
    <% end %>
  </div>

  <div class="form-group">
    <%#= search_field_tag :keywords,
                         params[:keywords],
                         :placeholder => Spree.t(:search),
                         class: "form-control",
                         id: "search"
    %>
    <%= text_field_tag :q,
                       params[:q],
                       placeholder: Spree.t(:search),
                       class: 'form-control',
                       id: 'search'
    %>
    <%= submit_tag Spree.t(:search),
                   name: nil,
                   class: 'btn btn-lrg btn-success' %>
  </div>

<% end %>